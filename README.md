# ABRAM
_Astronomical Bodies RAdiometric Model_

This tool allows to render with radiometric consistency celestial spherical objects considering any camera pointing and orientation or sun direction. The tool is based on radiometric equations and is NOT a ray tracer. An example of rendering of Mars from 74 500 km using the ISRU Mars Color Camera is shown in the following picture:

![cover](https://github.com/andrepiz/abram/assets/75851004/8163552c-7de7-4488-b037-895141902ab2)

Several BRDFs are implemented and the user can mix them to find the more realistic model depending on the body considered. 

Lambert (left), Lommel-Seeliger (center) and Oren-Mayar (right) reflection models are shown applied to a simple sphere without texture in the following pictures: 

![image](https://github.com/andrepiz/abram/assets/75851004/05ca828f-6a2a-431c-b16e-98564dd6eefc)

ABRAM has been validated against real space images acquired by the AMIE camera on-board of the SMART-1 mission. For example, considering the photo taken by AMIE on 19 August 2004 at 30 ms exposure time, the same scenario is created in ABRAM using SPICE kernels and metadata of the AMIE image and a very good visual similarity is obtained:

![abramvsamie_img](https://github.com/andrepiz/abram/assets/75851004/98f3b4e7-e2c4-4657-b03a-bed8fa5e77cb)

Finally, the tool can calibrate radiometrically rendering software such as Blender or Unreal Engine. For instance, the Blender "solar strength" can be tuned to minimize the image differences between Blender and ABRAM, while keeping the same real exposure time. In this way, a radiometric calibration of Blender is carried out. A comparison of the Moon rendered with after-calibration Blender (left) against an image generated by ABRAM (right) is shown in the following picture. 

![image](https://github.com/andrepiz/abram/assets/75851004/f3ecb086-d8ca-4f3c-bb7f-40af87392a35)

The tool is based on the radiometric equations of reflection of light from a sphere, integrated across discretized surface sectors, to deliver a point cloud of PL coefficients, i.e. reflected Power (P) over emitted Radiance (L). 

![image](https://github.com/andrepiz/abram/assets/75851004/9caef538-c6c8-4f55-bff6-2b5087c96804)

These coefficients are then projected onto the camera matrix and binned to form a 2D quantized matrix. 

![image](https://github.com/andrepiz/abram/assets/75851004/1bb7dbc9-2e76-4989-ac5b-32340c232bad)

The power at each pixel is then obtained multiplying PL for the radiance emitted by the star integrated across the desired wavelengths. Following the same approach, the Photon Count Rate (PCR), the Electron Count Rate (ECR) and the Electron Count (EC) can be obtained considering the Transmittivity (T), the Quantum Efficiency (QE) and the exposure time (tExp) of the camera. Finally, the rendered image is obtained from the EC multiplying for the Analog-to-Digital (AD) gain.

[1] Lester, Timothy P., MARSHALL L. McCall, and J. B. Tatum. "Theory of planetary photometry." Journal of the Royal Astronomical Society of Canada.
